---
title: "Testing Notes"
output: html_notebook
---

## Introduction

To automate our testing process, we utilized the testing framework 'testthat' package (ver. 3.1.4) in R (ver. 4.2.2). Following the 'testthat' framework, we created the recommended testing structure in which there is a "testthat" directory that lives in the "tests" directory.

Use case files and toy datasets are set in the "tests" directory, while all testing scripts are set in the "testthat" directory. For each R script (in the R folder), there is a test in the "testthat" directory that checks the output of that function. For example, for a given R script such as "getCorrelationCoefficients_withinGroup.R", located in our "R" folder, there is a test script in the "testthat" directory that directly checks this function: "test\_ getCorrelationCoefficients_withinGroup.R". In this file, the input files are both a toy counts table and metadata file;

### Running tests locally

The 'testthat' framework allows us to run either the entire testing directory (source_dir("tests/testthat)) or individual test files automatically (source_file("/test/getCorrelationCoefficients_withinGroup.R"). To run our tests locally, we recommend setting up your directory structure and nomenclature as such, with the "testthat" folder nested into a "tests" folder. Otherwise, please note and adjust relative paths in each of the testing scripts, in which the current relative path structure is: "./tests/toydataset.txt" and testing scripts are in "./tests/testthat/testingscript.R" path.

Here is an example of running an individual test file with the "source" function. 
```{r}
source("tests/testthat/test_getCorrelationCoefficient_withinGroup.R")
source("tests/testthat/test_getCorrelationCoefficient_acrossGroup.R")
source("tests/test_countsTableInput.R")

```

To run all testing scripts within the directory, use the "test_dir" function.

```{r}
test_dir("./tests/testthat/")
```

Note: Running individual test files with the "test_file" or "test_dir" function will not pass tests if the toy datasets or use case files are imported with relative paths; they will pass without issues if the paths are absolute.


#### References

<https://testthat.r-lib.org/>

<https://www.r-bloggers.com/2019/11/automated-testing-with-testthat-in-practice/>
